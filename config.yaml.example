analysis:
  duration: 10
  idet_frames: 500
  retries: 1
  retry_delay: 10
  timeout: 30
  workers: 8
filters:
  channel_group_ids: []  # Add your channel group IDs here
  remove_duplicates: true
  specific_channel_ids: []  # Add specific channel IDs here (optional)
  # Optional: regex-based channel selection (auto-generated by the web UI if you use "Save selection as regex")
  channel_name_regex: ""  # e.g. ^(?:BBC One|BBC Two)$
  channel_number_regex: ""  # e.g. ^(?:101|102|103)$
  stream_last_measured_days: 0
scoring:
  proxy_first: true  # Enable proxy-first validation-led scoring; set false to keep legacy scoring
  # Legacy scoring knobs (used when proxy_first is false)
  fps_bonus_points: 100
  hevc_boost: 1.5
  resolution_scores:
    "3840x2160": 100
    "1920x1080": 80
    "1280x720": 50
    "960x540": 20
ordering:
  # Resilience mode enables multi-tier failover while keeping failed streams demoted
  resilience_mode: false
  fallback_depth: 3
  similar_score_delta: 5
  # Enable reliability-first ordering (uses cached historical outcomes; default is unchanged)
  reliability_sort: false
  # Background optimization toggles (optional; enable only if you supply history/playback metadata)
  background_optimize: false
  sequence_optimize: false
  sequence_candidate_pool: 0
  sequence_diversity_weight: 0.08
  diversity_top_n: 0
  diversity_weight: 0.15
  stability_weight: 0.0
  recent_failure_minutes: 60
  recent_failure_penalty: 0.12
  playback_weight: 0.15
  adaptive_tiers: false
  adaptive_hd_percentile: 0.8
  adaptive_frames_percentile: 0.7
  pareto_sort: false
  cluster_similar: false
  optimize_slot1: false
  slot1_candidate_limit: 5
dispatcharr:
  m3u_accounts_endpoint: /api/channels/m3u-accounts/
  manage_py_path: ""  # Optional: path to Dispatcharr manage.py for direct DB access
  container_name: "dispatcharr"  # Optional: Docker container name for manage.py exec
  # docker_container: "dispatcharr"  # Required for provider metadata discovery when Dispatcharr runs in Docker
  refresh_provider_data: false  # Set true to overwrite provider_map/provider_metadata

# Optional web settings (used by the web UI/server)
web:
  # Optional retention policy for job workspaces + job history.
  # Set to 0/blank to disable. If set (e.g. 30), jobs older than N days are pruned.
  # You can also set env DISPATCHARR_MAID_RESULTS_RETENTION_DAYS which takes precedence.
  results_retention_days: 0

# Optional: derive "viewing activity" from reverse-proxy access logs (e.g. Nginx Proxy Manager).
# This is ONLY relevant if your IPTV app streams via Dispatcharr (Xtream/M3U served by Dispatcharr),
# so the proxy can see playback URLs like /live/<user>/<pass>/<stream_id>.ts.
usage:
  # Mount your proxy log directory into the Maid container, then point at it here.
  # Example for NPM: mount the NPM /data/logs/ folder into Maid at /app/npm_logs
  access_log_dir: "/app/npm_logs"
  # Which files to parse (glob, non-recursive within access_log_dir)
  access_log_glob: "proxy-host-*_access.log*"
  # Default lookback for the API endpoint (days)
  lookback_days: 7
  # Approximate "sessions" by starting a new session when a client/stream has a gap > N seconds.
  # This helps de-duplicate HLS segment requests into something closer to "plays".
  session_gap_seconds: 30
